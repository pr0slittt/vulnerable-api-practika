rules:
  - id: info-disclosure-tokens-get
    patterns:
      - pattern: |
          @route("/tokens", method="GET")
          def $FUNC(...):
              ...
              $QUERY = "SELECT id, username, password FROM users"
              ...
              return {"response": $DATA}
    message: >
      [Info Disclosure] Sensitive user data (including password) is being returned via a GET request to `/tokens`.
      This endpoint is undocumented and should not expose credentials or user information.
    severity: ERROR
    languages: [python]
    metadata:
      cwe: "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
      owasp: "A3:2017 - Sensitive Data Exposure"
      category: security
      technology: bottle
    paths:
      include:
        - "*.py"
